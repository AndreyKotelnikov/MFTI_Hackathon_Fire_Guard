# FireGuard Project

## Обзор
FireGuard — это комплексная система, предназначенная для обнаружения природных пожаров с использованием передовых моделей глубокого обучения. Проект интегрирует различные подходы машинного обучения, включая CNN, transfer learning и архитектуры YOLO, для анализа спутниковых и дроновых изображений. Его цель — предоставить надёжный инструмент для раннего обнаружения пожаров и, таким образом, дать пожарным и спасательным службам возможность своевременно принять необходимые меры по тушению пожара и/или авакуации жителей близлежащих территорий. 

---

## Важность проекта  
В период с 2001 по 2023 площадь, выжженная природными пожарами, увеличивалась в среднем на 5,4% ежегодно (по данным World Resources Institute). Считается, что одна из главных причин учащения лесных пожаров — изменение климата, при этом участившиеся пожары еще больше способствуют разогреву атмосферы. За год природные пожары выбрасывают около 5–8 миллиардов тонн CO₂, что составляет 10–15% от общего уровня выбросов углекислого газа в мире. Одновременно с этим природные пожары загрязняют воздух, повышая уровень заболеваемости респираторными и сердечно-сосудистыми заболеваниями, наносят ущерб дикой природе и инфраструктуре, а устранение их последствий стоит государствам немалых денег. И поскольку с каждым годом риск природных пожаров только увеличивается, растет и потребность в их мониторинге и раннем обнаружении. 

## Техническая идея  
FireGuard в режиме реального времени обрабатывает спутниковые изображения, автоматически анализируя их с помощью ансамбля из 5-ти deep learning моделей. На данный момент пользовательский интерфейс проекта реализован в виде общедоступной страницы в Интернете, расположенной по адресу: [http://138.124.124.71/](http://138.124.124.71/). Попав на страницу, пользователь может загрузить изображение и увидеть с каковой вероятностью на загруженном снимке присутствует природный пожар. Пользователю доступен как итоговый вывод системы (который рассчитывается как средневзвешенный результат предсказаний всех моделей), так и предсказания каждой из 5-ти различных моделей по отдельности. 

## Дополнительная реализация идеи  
Поскольку проект разрабатывался в рамках учебной программы и в крайне сжатые сроки, некоторые дополнительные идеи не были реализованы. По задумке создателей, система должна получать снимки со спутника в режиме реального времени через API, исследовать их, и, при обнаружении пожара, отправлять мгновенные уведомления о возможных очагах возгорания операторам экстренных служб. Вместе с оповещением о начинающемся пожаре, система должна высылать точные координаты точки возгорания, а также оценку уже пораженной пожаром площади. 

## Повышение надежности предсказания за счет использования ансамбля моделей  
Для обеспечения максимальной точности предсказания система использует ансамбль из пяти моделей, включая предобученные ResNet и YOLO, а также собственные CNN. 
* Итоговое предсказание — средневзвешенная оценка по всем моделям.  
* Такой подход гарантирует более стабильный и достоверный прогноз природных пожаров.
---

## Модели и ноутбуки

Директория `notebooks` содержит несколько Jupyter ноутбуков, каждый из которых посвящён определённой модели или подходу. В соответствующей папке для каждой модели размещён отдельный `README.md` с подробным описанием её архитектуры, используемых гиперпараметров и итоговых результатов тренировки.


### 1. **cnn-wildfire-prediction**
- **Описание**: Реализует сверточную нейронную сеть (CNN) для прогнозирования пожаров с использованием наборов данных изображений.
- **Цель**: Служит базовой моделью для классификации изображений как "пожар" или "нет пожара".
- **Фреймворк**: TensorFlow's Keras API.

### 2. **keras-wildfire**
- **Описание**: Использует Keras для обучения и оценки модели обнаружения пожаров.
- **Цель**: Упрощает процесс обучения для пользователей, знакомых с Keras, предоставляя удобный API для построения моделей.
- **Фреймворк**: Keras (бэкенд TensorFlow).

### 3. **resnet18-finetuned**
- **Описание**: Дообучает предварительно обученную модель ResNet18 для бинарной классификации (пожар против нет пожара).
- **Цель**: Использует transfer learning для достижения высокой точности при ограниченных данных.
- **Фреймворк**: PyTorch.

### 4. **yolov11n-cls-forest-fire**
- **Описание**: Исследует использование YOLOv1 для задач классификации пожаров.
- **Цель**: Тестирует возможность применения более старой архитектуры YOLO для задач классификации на уровне изображений.
- **Фреймворк**: PyTorch или Darknet (уточните в ноутбуке).

### 5. **yolov8n-cls-wildfire-satellite**
- **Описание**: Обучает и оценивает YOLOv8 для классификации пожаров, специально на спутниковых изображениях.
- **Цель**: Высокопроизводительная классификация спутниковых изображений с фокусом на регионах с пожарами.
- **Фреймворк**: Ultralytics YOLOv8.

### 6. **yolov8n-wildfire-roboflow**
- **Описание**: Интегрирует YOLOv8 с Roboflow для предварительной обработки и аугментации наборов данных.
- **Цель**: Демонстрирует расширенные пайплайны аугментации и рабочие процессы обучения для обнаружения пожаров.
- **Фреймворк**: Ultralytics YOLOv8 + Roboflow API.

---

## Структура проекта

```
FireGuard/
|
|-- backend/          # Серверная часть для обработки инференса и API.
|-- frontend/         # Веб-интерфейс для отображения предсказаний и мониторинга.
|-- notebooks/        # Jupyter ноутбуки для обучения и оценки моделей.
    |-- cnn-wildfire-prediction
    |-- keras-wildfire
    |-- resnet18-finetuned
    |-- yolov11n-cls-forest-fire
    |-- yolov8n-cls-wildfire-satellite
    |-- yolov8n-wildfire-roboflow
|-- data/             # (Опционально) Папка для наборов данных, используемых в обучении.
|-- README.md         # Документация проекта.
```

---

## Функционал

1. **Обнаружение пожаров**: Классификация изображений на категории "пожар" или "нет пожара" с использованием различных архитектур.
2. **Анализ спутниковых изображений**: Фокусируется на обнаружении пожаров на спутниковых изображениях высокой точности.
3. **Анализ изображений с дронов**: Обнаруживает огонь и дым на изображениях, сделанных с дронов.
4. **Интеграция пользовательских наборов данных**: Позволяет обучать модели на пользовательских наборах данных с минимальными изменениями.
5. **Веб-интерфейс**: Обеспечивает мониторинг в реальном времени и визуализацию предсказаний.

---

## Как запустить проект

### Требования
- Python 3.8+
- Рекомендуется: GPU с поддержкой CUDA для ускорения обучения.
- Необходимые Python-библиотеки:
  ```bash
  pip install -r requirements.txt
  ```

### Шаги

1. **Клонирование репозитория**
   ```bash
   git clone https://github.com/AndreyKotelnikov/MFTI_Hackathon_Fire_Guard.git
   cd MFTI_Hackathon_Fire_Guard
   ```

2. **Подготовка наборов данных**
   - Разместите свои наборы данных в директории `data/` (или укажите пути в ноутбуках).
   - Убедитесь, что наборы данных структурированы следующим образом:
     ```
     data/
     |-- train/
         |-- fire/
         |-- no_fire/
     |-- test/
         |-- fire/
         |-- no_fire/
     ```

3. **Запуск ноутбуков**
   - Перейдите в директорию `notebooks/`.
   - Откройте и выполните нужный ноутбук (например, `resnet18-finetuned`) с помощью Jupyter:
     ```bash
     jupyter notebook
     ```

4. **Обучение моделей**
   - Настройте гиперпараметры при необходимости (например, размер батча, скорость обучения).
   - Выполняйте ячейки пошагово для обучения моделей.

5. **Развёртывание моделей**
   - Используйте директорию `backend/` для настройки API инференса.
   - Настройте фронтенд для визуализации в реальном времени.

---

## Участие в разработке
- Приветствуются ваши вклады! Пожалуйста, форкните репозиторий и создайте pull request с вашими изменениями.

---

## Лицензия
Этот проект лицензирован под MIT License. Подробнее см. файл `LICENSE`.

## Авторы, группа 13, emails:
  - Катрин Почтар katrindarart@gmail.com
  - Марина Семушина semushinamarina@yandex.ru
  - Екатерина Цыбина spellful.mail@gmail.com


